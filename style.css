/* ═══════════════════════════════════════════════════════════
   故事接龍 · Style Sheet  (dark-ink manuscript aesthetic)
   ═══════════════════════════════════════════════════════════ */
:root {
  --bg0:        #0e0d10;
  --bg1:        #141319;
  --bg2:        #1c1a23;
  --bg3:        #242130;
  --bg4:        #2d2a3e;
  --border:     #2e2c40;
  --border2:    #403d58;
  --gold:       #c9a84c;
  --gold2:      #e8c96b;
  --gold-glow:  rgba(201,168,76,.25);
  --red-ink:    #c04040;
  --teal:       #4ac0a0;
  --teal-glow:  rgba(74,192,160,.2);
  --purple:     #9b85e8;
  --txt0:       #f0eee8;
  --txt1:       #9898b8;
  --txt2:       #55546a;
  --radius:     16px;
  --radius-sm:  10px;
  --shadow:     0 12px 48px rgba(0,0,0,.6);
  --shadow-sm:  0 4px 20px rgba(0,0,0,.4);
  --serif:      'Noto Serif TC','Georgia',serif;
  --sans:       'Noto Sans TC','PingFang TC',sans-serif;
  --ease:       .2s ease;
}
*, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
html { height: 100%; font-size: 16px; }
body {
  font-family: var(--sans);
  background: var(--bg0);
  color: var(--txt0);
  min-height: 100vh;
  line-height: 1.65;
  -webkit-font-smoothing: antialiased;
}

/* ── Noise texture ──────────────────────────────────────── */
.bg-noise {
  position: fixed; inset: 0; pointer-events: none; z-index: 0;
  opacity: .5;
  background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 256 256' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23n)' opacity='0.05'/%3E%3C/svg%3E");
}

/* ── Screens ────────────────────────────────────────────── */
.screen {
  position: relative; z-index: 1;
  min-height: 100vh;
  display: flex; align-items: center; justify-content: center;
  padding: 28px 16px;
}
.screen.hidden { display: none !important; }

/* ── Containers ─────────────────────────────────────────── */
.container      { width: 100%; max-width: 460px; }
.container.wide { max-width: 820px; }

/* ── Hero ───────────────────────────────────────────────── */
.hero { text-align: center; margin-bottom: 40px; }
.hero-glyph {
  font-family: var(--serif);
  font-size: 5rem; font-weight: 900; line-height: 1;
  color: transparent; -webkit-text-stroke: 2px var(--gold);
  text-shadow: 0 0 60px var(--gold-glow);
  margin-bottom: 10px;
  animation: float 4s ease-in-out infinite;
}
@keyframes float { 0%,100%{transform:translateY(0)} 50%{transform:translateY(-7px)} }
.logo {
  font-family: var(--serif);
  font-size: 2.6rem; font-weight: 900; letter-spacing: 2px;
  background: linear-gradient(135deg,var(--gold) 0%,var(--gold2) 60%,var(--txt0) 100%);
  -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text;
}
.subtitle { color: var(--txt1); font-size: .9rem; margin-top: 8px; letter-spacing: .5px; }

/* ── Card ───────────────────────────────────────────────── */
.card {
  background: var(--bg2); border: 1px solid var(--border);
  border-radius: var(--radius); padding: 32px; box-shadow: var(--shadow);
  position: relative; overflow: hidden;
}
.card::before {
  content: ''; position: absolute; inset: 0; border-radius: inherit;
  background: linear-gradient(135deg,rgba(201,168,76,.04) 0%,transparent 60%);
  pointer-events: none;
}

/* ── Forms ──────────────────────────────────────────────── */
.form-group { margin-bottom: 22px; }
.form-group label {
  display: block; font-size: .75rem; font-weight: 600;
  color: var(--txt1); text-transform: uppercase; letter-spacing: 1px; margin-bottom: 8px;
}
.form-row { display: flex; gap: 16px; }
.form-group.half { flex: 1; }
input[type=text],
input[type=number],
textarea {
  width: 100%; background: var(--bg1);
  border: 1.5px solid var(--border); border-radius: var(--radius-sm);
  color: var(--txt0); font-family: var(--sans); font-size: .95rem;
  padding: 11px 15px; outline: none;
  transition: border-color var(--ease), box-shadow var(--ease);
}
input:focus, textarea:focus {
  border-color: var(--gold);
  box-shadow: 0 0 0 3px var(--gold-glow);
}
input::placeholder, textarea::placeholder { color: var(--txt2); }
textarea { resize: vertical; min-height: 140px; line-height: 1.8; }
textarea:disabled { opacity: .5; cursor: not-allowed; }
input[type=number] { -moz-appearance: textfield; }
input[type=number]::-webkit-inner-spin-button,
input[type=number]::-webkit-outer-spin-button { -webkit-appearance: none; }

/* ── Buttons ────────────────────────────────────────────── */
.btn {
  display: inline-flex; align-items: center; justify-content: center; gap: 6px;
  padding: 11px 24px; border-radius: var(--radius-sm); border: none;
  cursor: pointer; font-family: var(--sans); font-size: .93rem; font-weight: 600;
  transition: all var(--ease); user-select: none; white-space: nowrap;
}
.btn:active { transform: scale(.97); }
.btn-primary {
  background: linear-gradient(135deg,var(--gold) 0%,#a0762a 100%);
  color: #0e0d10; box-shadow: 0 4px 20px var(--gold-glow);
}
.btn-primary:hover { filter: brightness(1.1); box-shadow: 0 6px 28px rgba(201,168,76,.45); }
.btn-accent {
  background: linear-gradient(135deg,var(--teal) 0%,#2e9070 100%);
  color: #0e0d10; box-shadow: 0 4px 20px var(--teal-glow);
}
.btn-accent:hover { filter: brightness(1.1); }
.btn-secondary { background: transparent; border: 1.5px solid var(--border2); color: var(--txt0); }
.btn-secondary:hover { background: var(--bg3); }
.btn-ghost { background: transparent; border: 1.5px solid transparent; color: var(--txt1); }
.btn-ghost:hover { color: var(--txt0); border-color: var(--border2); }
.btn-sm   { padding: 7px 16px; font-size: .82rem; }
.btn-full { width: 100%; }
.btn-icon {
  background: transparent; border: none; cursor: pointer;
  font-size: 1.1rem; padding: 4px 6px; opacity: .6; transition: opacity var(--ease);
}
.btn-icon:hover { opacity: 1; }

/* ── Join row / btn groups ──────────────────────────────── */
.btn-group-vert { display: flex; flex-direction: column; gap: 12px; }
.divider { display: flex; align-items: center; gap: 12px; color: var(--txt2); font-size: .78rem; }
.divider::before,.divider::after { content: ''; flex: 1; height: 1px; background: var(--border); }
.join-row { display: flex; gap: 8px; }
.join-row input { flex: 1; text-transform: uppercase; letter-spacing: 4px; font-weight: 700; text-align: center; }

/* ── Radio ──────────────────────────────────────────────── */
.radio-group { display: flex; flex-direction: column; gap: 8px; }
.radio-label {
  display: flex; align-items: center; gap: 10px; cursor: pointer;
  font-size: .88rem; padding: 10px 14px; border-radius: var(--radius-sm);
  border: 1.5px solid var(--border);
  transition: border-color var(--ease), background var(--ease);
}
.radio-label:has(input:checked) { border-color: var(--gold); background: rgba(201,168,76,.08); }
.radio-label input[type=radio] { display: none; }
.radio-box {
  width: 16px; height: 16px; border-radius: 50%;
  border: 2px solid var(--border2); flex-shrink: 0; transition: all var(--ease);
}
.radio-label:has(input:checked) .radio-box {
  border-color: var(--gold); background: var(--gold); box-shadow: 0 0 0 3px var(--gold-glow);
}
.round-hint {
  font-size: .78rem; color: var(--txt2); margin-bottom: 18px;
  padding: 8px 12px; background: var(--bg1); border-radius: var(--radius-sm);
  border-left: 2px solid var(--gold);
}

/* ── ROOM ───────────────────────────────────────────────── */
#screen-room { align-items: flex-start; padding-top: 36px; }
.room-topbar {
  display: flex; align-items: center; justify-content: space-between;
  margin-bottom: 24px; flex-wrap: wrap; gap: 12px;
}
.room-code-wrap { display: flex; align-items: center; gap: 10px; }
.topbar-label { color: var(--txt2); font-size: .75rem; font-weight: 600; text-transform: uppercase; letter-spacing: 1px; }
.room-code-badge {
  font-family: var(--serif); font-size: 2rem; font-weight: 700; letter-spacing: 6px;
  color: var(--gold2); text-shadow: 0 0 24px var(--gold-glow);
}
.room-body { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; }
@media(max-width:620px) { .room-body { grid-template-columns: 1fr; } }

/* ── Panel ──────────────────────────────────────────────── */
.panel { background: var(--bg2); border: 1px solid var(--border); border-radius: var(--radius); padding: 22px; box-shadow: var(--shadow-sm); }
.panel-header {
  font-size: .75rem; font-weight: 700; color: var(--txt1);
  text-transform: uppercase; letter-spacing: 1px; margin-bottom: 16px;
  display: flex; align-items: center; justify-content: space-between;
}
.host-crown { font-size: .7rem; color: var(--gold); background: rgba(201,168,76,.12); padding: 2px 8px; border-radius: 20px; }
.badge-count { background: var(--bg3); color: var(--gold); font-size: .72rem; padding: 2px 9px; border-radius: 20px; }

/* ── Player list ────────────────────────────────────────── */
.players-list { list-style: none; display: flex; flex-direction: column; gap: 7px; }
.player-item {
  display: flex; align-items: center; gap: 10px;
  padding: 10px 13px; background: var(--bg1);
  border-radius: var(--radius-sm); border: 1px solid var(--border); transition: border-color var(--ease);
}
.player-item.is-host { border-color: rgba(201,168,76,.3); }
.player-avatar {
  width: 34px; height: 34px; border-radius: 50%;
  display: flex; align-items: center; justify-content: center;
  font-family: var(--serif); font-weight: 700; font-size: .88rem; flex-shrink: 0; color: #000;
}
.player-name { flex: 1; font-weight: 500; font-size: .9rem; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; }
.player-badges { display: flex; gap: 4px; flex-wrap: wrap; }
.p-badge { font-size: .65rem; padding: 2px 7px; border-radius: 20px; font-weight: 700; white-space: nowrap; }
.p-badge-host { background: rgba(201,168,76,.18); color: var(--gold2); }
.p-badge-you  { background: rgba(74,192,160,.15);  color: var(--teal); }
.p-badge-conn { background: rgba(74,192,160,.1);   color: var(--teal); }
.p-badge-disc { background: rgba(192,64,64,.1);    color: var(--red-ink); }

/* ── Waiting panel ──────────────────────────────────────── */
.waiting-panel { display: flex; flex-direction: column; align-items: center; justify-content: center; gap: 14px; text-align: center; padding: 40px 20px; }
.waiting-text  { font-family: var(--serif); font-weight: 600; font-size: 1rem; }
.waiting-hint  { font-size: .82rem; color: var(--txt2); }

/* ── Spinner ────────────────────────────────────────────── */
.spinner {
  width: 24px; height: 24px;
  border: 2.5px solid var(--border2); border-top-color: var(--gold);
  border-radius: 50%; animation: spin .7s linear infinite; flex-shrink: 0;
}
.spinner.large { width: 46px; height: 46px; border-width: 3.5px; }
@keyframes spin { to { transform: rotate(360deg); } }

/* ══ GAME SCREEN ════════════════════════════════════════════ */
#screen-game { align-items: flex-start; padding: 0; }
/* ══════════════════════════════════════════════════════
   STORY RELAY — PREMIUM REDESIGN
══════════════════════════════════════════════════════ */
.game-wrap {
  width: 100%; min-height: 100vh;
  max-width: 680px; margin: 0 auto;
  padding: 20px 16px 80px;
  display: flex; flex-direction: column; gap: 16px;
}

/* ── Floating capsule header ────────────────────────── */
.game-header {
  display: flex; align-items: center; justify-content: space-between;
  padding: 12px 18px;
  background: rgba(20,19,25,.85);
  border: 1px solid rgba(201,168,76,.18);
  border-radius: 50px;
  backdrop-filter: blur(16px);
  box-shadow: 0 4px 24px rgba(0,0,0,.5), 0 0 0 1px rgba(201,168,76,.06);
  flex-wrap: wrap; gap: 8px;
  position: sticky; top: 12px; z-index: 10;
}
.game-meta    { display: flex; align-items: center; gap: 8px; flex-wrap: wrap; }
.round-label  { font-family: var(--serif); font-weight: 700; font-size: .95rem; color: var(--gold2); }
.turn-label   { font-size: .75rem; color: var(--txt1); background: rgba(255,255,255,.06); padding: 3px 9px; border-radius: 20px; }
.phase-badge  { font-size: .65rem; padding: 3px 10px; border-radius: 20px; font-weight: 700; text-transform: uppercase; letter-spacing: .5px; }
.phase-badge.writing   { background: rgba(74,192,160,.2);  color: var(--teal); }
.phase-badge.revealing { background: rgba(201,168,76,.2);  color: var(--gold2); }
.phase-badge.finished  { background: rgba(155,133,232,.2); color: var(--purple); }
.game-header-right { display: flex; align-items: center; gap: 12px; }
.lock-count-text  { font-size: .78rem; color: var(--txt1); }

/* ── Timer ring ─────────────────────────────────────── */
.game-timer { display: flex; align-items: center; gap: 0; }
.timer-ring-wrap {
  position: relative; width: 40px; height: 40px;
  display: flex; align-items: center; justify-content: center;
}
.timer-ring { width: 40px; height: 40px; transform: rotate(-90deg); position: absolute; }
.timer-ring-bg   { fill: none; stroke: rgba(255,255,255,.08); stroke-width: 3; }
.timer-ring-fill {
  fill: none; stroke: var(--gold); stroke-width: 3;
  stroke-linecap: round; transition: stroke-dashoffset .9s linear;
}
.timer-value {
  position: relative; font-size: .85rem; font-weight: 800;
  font-variant-numeric: tabular-nums; color: var(--gold2);
  line-height: 1;
}
.game-timer.urgent .timer-ring-fill { stroke: #ef4444; }
.game-timer.urgent .timer-value     { color: #ef4444; animation: pulse-icon 1s infinite; }
@keyframes pulse-icon { 0%,100%{opacity:1} 50%{opacity:.4} }

/* ── Phase: Writing ─────────────────────────────────── */
.game-phase-writing { display: flex; flex-direction: column; gap: 14px; }

/* Manuscript context scroll */
.manuscript-context {
  background: linear-gradient(135deg, rgba(201,168,76,.05) 0%, rgba(20,19,25,.8) 100%);
  border: 1px solid rgba(201,168,76,.2);
  border-left: 3px solid var(--gold);
  border-radius: var(--radius); padding: 16px 20px;
  min-height: 80px; position: relative; overflow: hidden;
}
.manuscript-context::before {
  content: ''; position: absolute; top: 0; right: 0;
  width: 80px; height: 100%;
  background: linear-gradient(270deg, rgba(201,168,76,.04) 0%, transparent 100%);
  pointer-events: none;
}
.manuscript-context-label {
  font-size: .68rem; font-weight: 700; color: var(--gold);
  text-transform: uppercase; letter-spacing: 1.5px;
  margin-bottom: 10px; display: flex; align-items: center; gap: 6px;
}
.ctx-quill { font-size: .8rem; opacity: .7; }
.manuscript-text {
  font-family: var(--serif); font-size: .93rem; line-height: 1.9;
  color: var(--txt1); white-space: pre-wrap;
}
.manuscript-text.has-content { color: var(--txt0); }
.context-placeholder { color: var(--txt2); font-style: italic; }

/* Writing card */
.writing-card {
  background: var(--bg2); border: 1px solid var(--border);
  border-radius: var(--radius); padding: 18px 20px;
  box-shadow: var(--shadow-sm); display: flex; flex-direction: column; gap: 12px;
  transition: border-color .2s;
}
.writing-card:focus-within { border-color: rgba(74,192,160,.4); }
.writing-card-top {
  display: flex; align-items: center; justify-content: space-between;
}
.writing-card-label { font-size: .72rem; font-weight: 700; color: var(--txt1); text-transform: uppercase; letter-spacing: 1px; }

/* Character ring counter */
.char-ring-wrap {
  position: relative; width: 30px; height: 30px;
  display: flex; align-items: center; justify-content: center;
}
.char-ring { width: 30px; height: 30px; transform: rotate(-90deg); position: absolute; }
.char-ring-bg   { fill: none; stroke: rgba(255,255,255,.06); stroke-width: 3; }
.char-ring-fill {
  fill: none; stroke: var(--teal); stroke-width: 3;
  stroke-linecap: round; transition: stroke-dashoffset .3s ease, stroke .2s;
}
.char-count-val {
  position: relative; font-size: .6rem; font-weight: 700;
  color: var(--txt2); line-height: 1;
}

/* Story textarea */
.story-textarea {
  width: 100%; background: transparent; border: none; outline: none; resize: none;
  font-family: var(--serif); font-size: .96rem; line-height: 1.85;
  color: var(--txt0); caret-color: var(--teal); padding: 0;
  min-height: 120px;
}
.story-textarea::placeholder { color: var(--txt2); font-style: italic; }
.story-textarea:disabled     { opacity: .5; pointer-events: none; }

.writing-actions { display: flex; gap: 10px; justify-content: flex-end; }
.btn-lock-story  { min-width: 120px; }

/* Waiting locked panel */
.waiting-locked-panel {
  background: linear-gradient(135deg, rgba(74,192,160,.08), rgba(20,19,25,.9));
  border: 1.5px solid rgba(74,192,160,.25); border-radius: var(--radius);
  padding: 20px 24px;
  animation: fadeSlideIn .4s ease forwards;
}
@keyframes fadeSlideIn { from{opacity:0;transform:translateY(8px)} to{opacity:1;transform:none} }
.waiting-locked-inner { display: flex; align-items: center; gap: 16px; }
.wl-lock-icon  { font-size: 2rem; flex-shrink: 0; animation: wlPulse 2s ease-in-out infinite; }
@keyframes wlPulse { 0%,100%{transform:scale(1)} 50%{transform:scale(1.12)} }
.wl-title { font-size: .95rem; font-weight: 700; color: var(--teal); }
.wl-sub   { font-size: .8rem; color: var(--txt1); margin-top: 2px; }
.wl-dots  { display: flex; gap: 5px; margin-left: auto; }
.wl-dots span {
  width: 6px; height: 6px; border-radius: 50%; background: var(--teal); opacity: .3;
  animation: dotBounce 1.2s ease-in-out infinite;
}
.wl-dots span:nth-child(2) { animation-delay: .2s; }
.wl-dots span:nth-child(3) { animation-delay: .4s; }
@keyframes dotBounce { 0%,100%{opacity:.3;transform:translateY(0)} 50%{opacity:1;transform:translateY(-4px)} }

/* ── Phase: Spectating ─────────────────────────────── */
.spec-banner {
  display: flex; align-items: center; justify-content: space-between;
  background: linear-gradient(135deg, rgba(155,133,232,.1), rgba(20,19,25,.8));
  border: 1px solid rgba(155,133,232,.2); border-radius: var(--radius);
  padding: 16px 20px; gap: 12px;
}
.spec-banner-left { display: flex; align-items: center; gap: 14px; }
.spec-banner-glyph { font-size: 1.8rem; opacity: .8; }
.spec-round-label  { font-family: var(--serif); font-weight: 700; font-size: .95rem; color: var(--txt0); }
.spec-lock-badge   { font-size: .75rem; color: var(--purple); margin-top: 2px; }
.spec-players-grid { display: flex; flex-wrap: wrap; gap: 8px; }
.spec-player-chip {
  display: flex; align-items: center; gap: 7px;
  padding: 8px 12px; border-radius: var(--radius-sm);
  background: var(--bg2); border: 1.5px solid var(--border);
  transition: border-color .25s, background .25s, transform .15s;
}
.spec-player-chip.locked {
  border-color: rgba(201,168,76,.4); background: rgba(201,168,76,.06);
  transform: scale(1.02);
}
.spec-avatar {
  width: 28px; height: 28px; border-radius: 50%;
  display: flex; align-items: center; justify-content: center;
  font-weight: 700; font-size: .75rem; color: #000; flex-shrink: 0;
}
.spec-pname     { font-size: .83rem; font-weight: 500; color: var(--txt0); }
.spec-lock-icon { font-size: .85rem; }

/* ── Phase: Revealing ──────────────────────────────── */
.reveal-header-bar {
  background: linear-gradient(135deg, rgba(201,168,76,.08), rgba(20,19,25,.8));
  border: 1px solid rgba(201,168,76,.2); border-radius: var(--radius);
  padding: 16px 20px; display: flex; align-items: center; gap: 16px; flex-wrap: wrap;
}
.reveal-header-title {
  display: flex; align-items: center; gap: 8px;
  font-family: var(--serif); font-size: 1.1rem; font-weight: 700; color: var(--gold2);
  flex-shrink: 0;
}
.reveal-quill { font-size: 1.3rem; }
.reveal-progress-pill { flex: 1; min-width: 140px; }
.reveal-progress-bar  {
  height: 5px; background: rgba(255,255,255,.06); border-radius: 3px; overflow: hidden; margin-bottom: 6px;
}
.reveal-progress-fill {
  height: 100%;
  background: linear-gradient(90deg, var(--gold) 0%, var(--gold2) 100%);
  border-radius: 3px; transition: width .6s cubic-bezier(.4,0,.2,1);
}
.reveal-subtitle-text { font-size: .75rem; color: var(--txt1); }

.reveal-stories-list  { display: flex; flex-direction: column; gap: 14px; }
.reveal-story-card {
  background: var(--bg2); border: 1px solid var(--border);
  border-radius: var(--radius); overflow: hidden;
  transition: border-color .3s, box-shadow .3s;
}
.reveal-story-card.r-active {
  border-color: var(--gold);
  box-shadow: 0 0 0 1px rgba(201,168,76,.15), 0 6px 24px rgba(0,0,0,.35);
}
.reveal-story-card.r-unrevealed { opacity: .35; }
.reveal-story-header {
  padding: 11px 18px; display: flex; align-items: center; justify-content: space-between;
  background: linear-gradient(90deg, rgba(201,168,76,.1) 0%, transparent 100%);
  border-bottom: 1px solid var(--border);
}
.reveal-story-num { font-family: var(--serif); font-weight: 700; color: var(--gold2); font-size: .9rem; }
.reveal-seg-count { font-size: .7rem; color: var(--txt2); background: var(--bg3); padding: 2px 8px; border-radius: 20px; }
.reveal-segs      { padding: 0; }
.reveal-seg {
  padding: 14px 20px; border-bottom: 1px dashed rgba(255,255,255,.06);
  animation: seg-in .5s cubic-bezier(.2,.8,.4,1) both;
}
.reveal-seg:last-child { border-bottom: none; }
@keyframes seg-in { from{opacity:0;transform:translateY(10px)} to{opacity:1;transform:none} }
.reveal-seg.r-new { background: rgba(201,168,76,.05); border-left: 3px solid var(--gold); }
.reveal-seg-meta   { font-size: .7rem; color: var(--txt2); margin-bottom: 6px; display: flex; align-items: center; gap: 6px; }
.reveal-seg-author { color: var(--gold); font-weight: 600; }
.reveal-seg-text   { line-height: 1.9; white-space: pre-wrap; color: var(--txt0); font-family: var(--serif); font-size: .93rem; }
.reveal-seg-empty  { padding: 20px; color: var(--txt2); font-style: italic; font-size: .85rem; text-align: center; }

.reveal-action-bar  { display: flex; flex-direction: column; align-items: center; gap: 12px; padding: 8px 0; }
.reveal-watch-hint  { color: var(--txt1); font-size: .83rem; }
.btn-gold {
  background: linear-gradient(135deg, var(--gold), var(--gold2));
  color: #1a1308; border: none; font-weight: 700;
}
.btn-gold:hover { filter: brightness(1.1); transform: translateY(-1px); }

/* ── Phase: Finished ────────────────────────────────── */
.finished-hero {
  text-align: center; padding: 24px 0 20px;
}
.finished-confetti {
  font-size: 3.5rem; display: block; margin-bottom: 12px;
  animation: float 3s ease-in-out infinite;
}
.finished-title  { font-family: var(--serif); font-size: 1.7rem; font-weight: 700; color: var(--gold2); }
.finished-sub    { color: var(--txt1); font-size: .88rem; margin-top: 6px; }
.finished-actions{ text-align: center; padding-top: 12px; }

.final-stories-list { display: flex; flex-direction: column; gap: 20px; }
.story-card {
  background: var(--bg2); border: 1px solid var(--border);
  border-radius: var(--radius); overflow: hidden; box-shadow: var(--shadow-sm);
}
.story-card-header {
  padding: 14px 20px;
  background: linear-gradient(90deg, rgba(201,168,76,.12) 0%, transparent 100%);
  border-bottom: 1px solid var(--border);
  font-family: var(--serif); font-weight: 700; color: var(--gold2); font-size: .95rem;
}
.story-card-body { padding: 0; }
.story-seg { padding: 16px 20px; border-bottom: 1px dashed rgba(255,255,255,.06); }
.story-seg:last-child { border-bottom: none; }
.story-seg-meta { font-size: .7rem; color: var(--txt2); margin-bottom: 6px; display: flex; align-items: center; gap: 6px; }
.story-seg-rnd  { background: var(--bg3); color: var(--txt2); font-size: .62rem; padding: 1px 6px; border-radius: 20px; }
.story-seg-text { line-height: 1.9; white-space: pre-wrap; color: var(--txt0); font-family: var(--serif); font-size: .93rem; }

/* ── Toast ──────────────────────────────────────────────── */
.toast {
  position: fixed; bottom: 28px; left: 50%;
  transform: translateX(-50%) translateY(0);
  background: var(--bg2); border: 1px solid var(--border2);
  border-radius: var(--radius); padding: 11px 24px;
  font-size: .86rem; box-shadow: var(--shadow); z-index: 1000; white-space: nowrap;
  transition: all .3s cubic-bezier(.4,0,.2,1);
}
.toast.hidden  { opacity: 0; pointer-events: none; transform: translateX(-50%) translateY(12px); }
.toast.success { border-color: var(--teal);    color: var(--teal); }
.toast.error   { border-color: var(--red-ink); color: #e06060; }
.toast.info    { border-color: var(--gold);    color: var(--gold2); }

/* ── Overlay ────────────────────────────────────────────── */
.overlay {
  position: fixed; inset: 0; background: rgba(0,0,0,.8);
  display: flex; align-items: center; justify-content: center;
  z-index: 2000; backdrop-filter: blur(8px);
}
.overlay.hidden { display: none; }
.overlay-content { display: flex; flex-direction: column; align-items: center; gap: 20px; color: var(--txt1); font-size: .95rem; }

/* ── Error ──────────────────────────────────────────────── */
.error-msg {
  margin-top: 10px; padding: 10px 15px;
  background: rgba(192,64,64,.1); border: 1px solid rgba(192,64,64,.3);
  border-radius: var(--radius-sm); color: #e06060; font-size: .86rem;
}
.error-msg.hidden { display: none; }

/* ── Spectator Badge in Room Player List ────────────── */
.p-badge-spec { background: rgba(155,133,232,.15); color: var(--purple); }

/* ── Night status bar ────────────────────────────────── */
.night-status-bar { display: flex; align-items: center; justify-content: space-between; padding: 10px 14px; background: rgba(255,255,255,.04); border-bottom: 1px solid var(--border); flex-shrink: 0; }
.night-step-label { font-size: .82rem; color: var(--txt1); }
.night-progress-badge { font-size: .8rem; color: var(--gold2); font-weight: 600; background: rgba(201,168,76,.12); border-radius: 20px; padding: 2px 10px; }

/* ── Settings Preview (non-host waiting panel) ───────── */
.waiting-panel { padding: 0; }
.waiting-panel .panel-header { padding: 14px 18px 12px; }
.settings-preview { padding: 0 18px 14px; display: flex; flex-direction: column; gap: 8px; }
.preview-row { display: flex; align-items: flex-start; gap: 10px; padding: 8px 0; border-bottom: 1px solid var(--border); }
.preview-row:last-child { border-bottom: none; }
.preview-label { font-size: .78rem; color: var(--txt2); font-weight: 600; min-width: 60px; padding-top: 2px; text-transform: uppercase; letter-spacing: .04em; }
.preview-val   { font-size: .87rem; color: var(--txt0); flex: 1; line-height: 1.5; }
.preview-roles .preview-val { font-size: .82rem; }
.waiting-footer { display: flex; flex-direction: column; align-items: center; gap: 8px; padding: 14px 18px 18px; border-top: 1px solid var(--border); }
.waiting-footer .spinner { width: 20px; height: 20px; }
.waiting-text { font-size: .85rem; color: var(--txt1); }

/* ── Bomber win banner ───────────────────────────────── */
.end-banner.bomber-win { background: rgba(201,168,76,.1); border: 2px solid rgba(201,168,76,.5); }
.bomber-win .end-title { color: var(--gold2); }

/* ── Bomber vote result chain ────────────────────────── */
.vr-bomber-chain { font-size: .82rem; color: #e07050; background: rgba(224,112,80,.08); border-radius: var(--radius-sm); padding: 8px 12px; margin-top: 6px; line-height: 1.6; }

/* ── Night panel footer (progress) ──────────────────── */
.night-panel-footer {
  position: sticky; bottom: 0;
  padding: 10px 20px;
  background: rgba(14,17,28,.85);
  border-top: 1px solid rgba(201,168,76,.2);
  text-align: center;
}
.night-progress-text {
  font-size: .8rem;
  color: var(--gold2);
  letter-spacing: .06em;
  text-transform: uppercase;
}

/* ── Witch active-choice button state ─────────────────── */
.btn.active-choice { background: rgba(41,182,146,.15); border-color: var(--teal); color: var(--teal); }
.btn.active-choice:disabled { opacity: 1; }

/* ══════════════════════════════════════════════════════
   DEATH ANNOUNCE — dramatic redesign
══════════════════════════════════════════════════════ */
.announce-peaceful {
  position: relative; overflow: hidden;
  display: flex; flex-direction: column; align-items: center; justify-content: center;
  min-height: 180px; padding: 32px;
  background: linear-gradient(135deg, rgba(134,239,172,.08) 0%, rgba(16,185,129,.05) 100%);
  border-radius: var(--radius);
  text-align: center;
}
.announce-peace-bg { position: absolute; inset: 0; background: radial-gradient(ellipse at 50% 20%, rgba(134,239,172,.12) 0%, transparent 70%); pointer-events: none; }
.announce-peace-icon { font-size: 3rem; line-height: 1; margin-bottom: 12px; animation: floatPetal 3s ease-in-out infinite; }
@keyframes floatPetal { 0%,100%{transform:translateY(0) rotate(-5deg)} 50%{transform:translateY(-8px) rotate(5deg)} }
.announce-peace-title { font-size: 1.6rem; font-weight: 700; color: #4ade80; margin: 0 0 6px; }
.announce-peace-sub { font-size: .85rem; color: var(--txt1); }

.announce-death-scene {
  background: linear-gradient(135deg, rgba(220,38,38,.1) 0%, rgba(127,29,29,.15) 100%);
  border: 1px solid rgba(220,38,38,.25);
  border-radius: var(--radius); padding: 24px 20px;
}
.announce-death-header { text-align: center; margin-bottom: 20px; }
.death-tolls { font-size: 1.4rem; margin-bottom: 8px; letter-spacing: 4px; }
.death-title { font-size: 1.4rem; font-weight: 700; color: #f87171; margin: 0; }

.death-cards-row { display: flex; gap: 12px; flex-wrap: wrap; justify-content: center; }
.death-card {
  display: flex; flex-direction: column; align-items: center; gap: 8px;
  background: rgba(0,0,0,.25); border: 1px solid rgba(220,38,38,.3);
  border-radius: var(--radius); padding: 16px 20px; min-width: 100px;
  animation: deathFade .6s ease forwards;
}
@keyframes deathFade { from{opacity:0;transform:scale(.85)} to{opacity:1;transform:scale(1)} }
.death-avatar-wrap { position: relative; }
.death-avatar {
  width: 56px; height: 56px; border-radius: 50%;
  display: flex; align-items: center; justify-content: center;
  font-size: 1.4rem; font-weight: 700; color: #fff;
  filter: grayscale(.8) brightness(.7);
  border: 2px solid rgba(220,38,38,.4);
}
.death-skull-badge {
  position: absolute; bottom: -4px; right: -4px;
  font-size: 1rem; background: var(--bg1); border-radius: 50%; line-height: 1;
}
.death-card-name { font-size: .9rem; font-weight: 600; color: #fca5a5; }
.death-card-label { font-size: .72rem; color: rgba(252,165,165,.6); }

/* ══════════════════════════════════════════════════════
   VOTE ABSTAIN
══════════════════════════════════════════════════════ */
.vote-abstain-area { display: flex; justify-content: center; padding: 10px 0 4px; }
.vote-abstain-btn {
  background: transparent; border: 1.5px dashed rgba(255,255,255,.2);
  color: var(--txt1); font-size: .82rem; padding: 8px 20px;
  border-radius: 20px; cursor: pointer; transition: all .2s;
}
.vote-abstain-btn:hover:not(:disabled) { border-color: rgba(255,255,255,.4); color: var(--txt0); }
.vote-abstain-btn.abstained {
  background: rgba(255,255,255,.06); border-color: rgba(255,255,255,.3);
  color: var(--txt0); cursor: default;
}
.vote-abstain-btn:disabled:not(.abstained) { opacity: .35; cursor: not-allowed; }

/* ══════════════════════════════════════════════════════
   VOTE RESULT — full-panel dramatic display
══════════════════════════════════════════════════════ */
.vr-no-elim {
  display: flex; flex-direction: column; align-items: center; justify-content: center;
  min-height: 200px; gap: 10px; text-align: center;
}
.vr-no-elim-icon { font-size: 2.8rem; }
.vr-no-elim-title { font-size: 1.5rem; font-weight: 700; color: var(--gold2); margin: 0; }
.vr-no-elim-sub { font-size: .85rem; color: var(--txt1); }

.vr-exile-scene, .vr-bomb-scene {
  display: flex; flex-direction: column; align-items: center;
  padding: 24px 16px; gap: 12px; text-align: center;
}
.vr-exile-cross {
  width: 60px; height: 60px; border-radius: 50%;
  background: rgba(220,38,38,.2); border: 2px solid rgba(220,38,38,.4);
  display: flex; align-items: center; justify-content: center;
  font-size: 1.6rem; font-weight: 900; color: #f87171;
  animation: popIn .4s cubic-bezier(.175,.885,.32,1.275) forwards;
}
.vr-exile-title { font-size: 1.4rem; font-weight: 700; color: #f87171; margin: 0; }
.vr-elim-row {
  display: flex; flex-direction: column; align-items: center; gap: 6px;
  background: rgba(0,0,0,.2); border-radius: var(--radius); padding: 14px 24px;
}
.vr-avatar { width: 52px; height: 52px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 1.3rem; font-weight: 700; color: #fff; }
.vr-avatar.dead-avatar { filter: grayscale(.8) brightness(.7); }
.vr-name { font-size: 1.1rem; font-weight: 700; }
.vr-vote-breakdown { display: flex; flex-wrap: wrap; gap: 6px; justify-content: center; margin-top: 4px; }
.vr-voter-chip { font-size: .75rem; background: rgba(220,38,38,.15); border: 1px solid rgba(220,38,38,.25); color: #fca5a5; padding: 3px 10px; border-radius: 12px; }
.vr-abstain-chip { font-size: .75rem; background: rgba(255,255,255,.05); border: 1px dashed rgba(255,255,255,.2); color: var(--txt1); padding: 3px 10px; border-radius: 12px; }
.vr-bomb-blast { font-size: 3.5rem; animation: boomPulse .5s ease forwards; }
@keyframes boomPulse { 0%{transform:scale(0.3);opacity:0} 60%{transform:scale(1.2)} 100%{transform:scale(1);opacity:1} }
.vr-bomb-title { font-size: 1.5rem; font-weight: 700; color: var(--gold2); margin: 0; }
.vr-bomber-chain { font-size: .82rem; color: #fca5a5; background: rgba(220,38,38,.1); border-radius: var(--radius-sm); padding: 8px 14px; }
.vr-abstain-note { font-size: .78rem; color: var(--txt1); }
@keyframes popIn { from{transform:scale(0);opacity:0} to{transform:scale(1);opacity:1} }

/* ══════════════════════════════════════════════════════
   SPECTATOR OVERLAY
══════════════════════════════════════════════════════ */
.ww-spectator-overlay {
  position: relative; z-index: 5;
  background: linear-gradient(135deg, rgba(99,102,241,.07) 0%, rgba(139,92,246,.05) 100%);
  border: 1.5px solid rgba(139,92,246,.25); border-radius: var(--radius);
  margin: 0 0 12px; overflow: hidden;
}
.spectator-content { padding: 0; }

.spectator-phase-bar {
  display: flex; align-items: center; gap: 10px; flex-wrap: wrap;
  background: rgba(139,92,246,.1); border-bottom: 1px solid rgba(139,92,246,.2);
  padding: 10px 16px;
}
.spec-badge {
  background: rgba(139,92,246,.25); color: #c4b5fd;
  font-size: .72rem; font-weight: 700; padding: 3px 10px; border-radius: 12px;
  letter-spacing: .06em; text-transform: uppercase;
}
.spec-phase { font-size: .9rem; font-weight: 600; color: var(--txt0); flex: 1; }
.spec-round { font-size: .78rem; color: var(--txt1); }

.spectator-role-table { width: 100%; }
.spec-table-header {
  display: grid; grid-template-columns: 1fr 48px 90px;
  padding: 8px 16px; font-size: .72rem; font-weight: 700;
  color: var(--txt1); text-transform: uppercase; letter-spacing: .05em;
  border-bottom: 1px solid var(--border);
}
.spec-row {
  display: grid; grid-template-columns: 1fr 48px 90px;
  align-items: center; padding: 9px 16px;
  border-bottom: 1px solid rgba(255,255,255,.04); cursor: pointer;
  transition: background .15s;
}
.spec-row:hover { background: rgba(255,255,255,.04); }
.spec-row.spec-dead { opacity: .5; }
.spec-name-cell { display: flex; align-items: center; gap: 8px; font-size: .88rem; }
.spec-mini-avatar {
  width: 26px; height: 26px; border-radius: 50%;
  display: flex; align-items: center; justify-content: center;
  font-size: .75rem; font-weight: 700; color: #fff; flex-shrink: 0;
}
.spec-alive-cell { text-align: center; font-size: .95rem; }
.spec-role-cell { font-size: .8rem; }
.spec-role-hidden { color: rgba(139,92,246,.6); font-style: italic; }
.spec-role-reveal { color: var(--txt0); font-weight: 600; }
.spectator-hint {
  font-size: .75rem; color: var(--txt1); text-align: center;
  padding: 10px 16px 14px; border-top: 1px solid var(--border);
  font-style: italic;
}

/* ── Scrollbar ──────────────────────────────────────────── */
::-webkit-scrollbar { width: 5px; height: 5px; }
::-webkit-scrollbar-track { background: transparent; }
::-webkit-scrollbar-thumb { background: var(--border2); border-radius: 3px; }

/* ── Utility ────────────────────────────────────────────── */
.hidden { display: none !important; }

/* ══════════════════════════════════════════════════════════
   WEREWOLF MODE STYLES
   ══════════════════════════════════════════════════════════ */

/* ── Room: Game Type Switcher ────────────────────────── */
.game-type-switcher {
  display: flex; gap: 8px; margin-bottom: 18px;
  background: var(--bg1); border: 1px solid var(--border);
  border-radius: var(--radius); padding: 4px;
}
.game-type-btn {
  flex: 1; padding: 8px 12px; border: none; border-radius: calc(var(--radius) - 3px);
  background: transparent; color: var(--txt1); font-size: .85rem;
  font-family: var(--sans); cursor: pointer; transition: background .2s, color .2s;
}
.game-type-btn.active {
  background: var(--bg3); color: var(--txt0); font-weight: 600;
}

/* ── Room: Role Config Grid ──────────────────────────── */
.ww-role-config { margin-bottom: 16px; }
.role-config-title { font-size: .8rem; font-weight: 600; color: var(--txt1); margin-bottom: 10px; text-transform: uppercase; letter-spacing: .05em; }
.role-config-hint  { font-weight: 400; color: var(--txt2); text-transform: none; letter-spacing: 0; }
.role-config-grid  { display: flex; flex-direction: column; gap: 6px; }
.role-row {
  display: flex; align-items: center; gap: 10px;
  padding: 8px 12px; background: var(--bg1); border: 1px solid var(--border);
  border-radius: var(--radius-sm);
}
.role-row.wolf-role { border-color: rgba(224,112,80,.3); background: rgba(224,112,80,.06); }
.rc-icon { font-size: 1.1rem; width: 22px; text-align: center; }
.rc-name { flex: 1; font-size: .88rem; color: var(--txt0); }
.rc-counter { display: flex; align-items: center; gap: 6px; }
.rc-num { min-width: 20px; text-align: center; font-weight: 700; color: var(--txt0); }
.role-counter-btn {
  width: 26px; height: 26px; border: 1px solid var(--border2); border-radius: 6px;
  background: var(--bg2); color: var(--txt0); font-size: 1rem; cursor: pointer;
  display: flex; align-items: center; justify-content: center; transition: background .15s;
}
.role-counter-btn:hover { background: var(--bg3); }
.ww-start-btn { margin-top: 4px; background: linear-gradient(135deg, #3a1f4a, #5c2e6e) !important; }

/* ── WW Game Screen ──────────────────────────────────── */
.ww-theme { background: var(--bg0) !important; }
.ww-wrap  { max-width: 560px; margin: 0 auto; padding: 0 16px 32px; min-height: 100vh; display: flex; flex-direction: column; }

.ww-header {
  display: flex; align-items: center; justify-content: space-between;
  padding: 14px 0 12px; border-bottom: 1px solid var(--border);
  margin-bottom: 20px; position: sticky; top: 0; background: var(--bg0); z-index: 10;
}
.ww-phase-label  { font-family: var(--serif); font-size: 1rem; font-weight: 700; color: var(--gold2); }
.ww-round-label  { font-size: .8rem; color: var(--txt1); margin-left: 8px; }
.ww-alive-badge  { font-size: .82rem; color: var(--txt1); }
.ww-night-timer  {
  font-family: var(--serif); font-size: 1.1rem; font-weight: 700; color: var(--teal);
  padding: 4px 12px; border: 1.5px solid var(--teal); border-radius: 20px;
  transition: color .3s, border-color .3s;
}
.ww-night-timer.urgent { color: #e07050; border-color: #e07050; animation: pulse 1s infinite; }

.ww-panel { flex: 1; display: flex; flex-direction: column; gap: 16px; }

/* ── Role Reveal ─────────────────────────────────────── */
.role-reveal-pre { text-align: center; color: var(--txt1); font-size: .9rem; margin-bottom: 4px; }
.role-card {
  display: flex; flex-direction: column; align-items: center; gap: 8px;
  padding: 28px 20px; border-radius: var(--radius);
  border: 2px solid var(--border); background: var(--bg2);
  transition: border-color .3s;
}
.role-card.role-wolf    { border-color: rgba(224,112,80,.5); background: rgba(224,112,80,.06); }
.role-card.role-village { border-color: rgba(74,192,160,.4); background: rgba(74,192,160,.05); }
.role-icon  { font-size: 3.5rem; }
.role-name  { font-family: var(--serif); font-size: 1.6rem; font-weight: 900; color: var(--txt0); }
.role-team  { font-size: .82rem; font-weight: 600; padding: 3px 12px; border-radius: 12px; background: var(--bg1); color: var(--txt1); }
.role-desc-txt { font-size: .84rem; color: var(--txt2); text-align: center; line-height: 1.6; max-width: 300px; }

.wolf-teammates { background: rgba(224,112,80,.07); border: 1px solid rgba(224,112,80,.3); border-radius: var(--radius); padding: 14px; }
.teammates-label { font-size: .82rem; color: #e07050; margin-bottom: 8px; font-weight: 600; }
.teammates-list { display: flex; flex-wrap: wrap; gap: 8px; }
.teammate-chip { display: flex; align-items: center; gap: 6px; padding: 5px 10px; background: var(--bg1); border-radius: 20px; font-size: .84rem; }
.teammate-role { font-size: .78rem; color: var(--txt2); }

.role-reveal-footer { display: flex; flex-direction: column; align-items: center; gap: 10px; margin-top: 8px; }
.ww-waiting-hint { font-size: .84rem; color: var(--txt2); text-align: center; }

/* ── Night ───────────────────────────────────────────── */
.night-subpanel { display: flex; flex-direction: column; gap: 14px; flex: 1; }
.night-header { text-align: center; padding-bottom: 6px; }
.night-moon   { font-size: 2.2rem; margin-bottom: 6px; }
.night-header h2 { font-family: var(--serif); font-size: 1.3rem; color: var(--gold2); }
.night-hint   { font-size: .84rem; color: var(--txt1); margin-top: 4px; }
.night-footer { display: flex; flex-direction: column; align-items: center; gap: 10px; }

.night-wait-scene {
  display: flex; flex-direction: column; align-items: center; justify-content: center;
  flex: 1; gap: 18px; padding: 32px 20px;
}
.stars { display: flex; gap: 24px; color: var(--txt2); font-size: 1.2rem; opacity: .5;
  animation: stars-twinkle 3s ease-in-out infinite; }
@keyframes stars-twinkle { 0%,100%{opacity:.3} 50%{opacity:.7} }
.night-moon-big { font-size: 4rem; animation: glyph-float 4s ease-in-out infinite; }
.night-step-label { font-family: var(--serif); font-size: 1.1rem; color: var(--txt0); text-align: center; }
.night-wait-hint  { font-size: .82rem; color: var(--txt2); text-align: center; }

/* ── Player Vote Grid ────────────────────────────────── */
.player-vote-grid { display: flex; flex-wrap: wrap; gap: 10px; justify-content: center; }
.player-vote-grid.small .vote-chip { min-width: 80px; padding: 8px 10px; }

.vote-chip {
  display: flex; flex-direction: column; align-items: center; gap: 5px;
  min-width: 90px; padding: 12px 10px;
  background: var(--bg2); border: 2px solid var(--border); border-radius: var(--radius);
  cursor: pointer; transition: border-color .2s, background .2s, transform .15s;
  user-select: none;
}
.vote-chip:hover:not(.self):not([onclick=""]) { border-color: var(--gold2); background: var(--bg3); transform: translateY(-2px); }
.vote-chip.selected { border-color: var(--gold2); background: rgba(201,168,76,.1); }
.vote-chip.checked-good { border-color: rgba(74,192,160,.6); background: rgba(74,192,160,.08); }
.vote-chip.checked-bad  { border-color: rgba(224,112,80,.6); background: rgba(224,112,80,.08); }
.vote-chip.self { opacity: .5; cursor: default; }
.vote-chip.vote-mode:not(.self) { cursor: pointer; }

.vote-avatar {
  width: 38px; height: 38px; border-radius: 50%; display: flex; align-items: center;
  justify-content: center; font-weight: 700; font-size: .9rem; color: #000; flex-shrink: 0;
}
.vote-avatar.sm { width: 28px; height: 28px; font-size: .75rem; }
.vote-chip span:not(.vote-tally):not(.seer-result) { font-size: .82rem; color: var(--txt0); text-align: center; }
.vote-tally { font-size: .74rem; font-weight: 700; color: var(--gold2); background: rgba(201,168,76,.15); border-radius: 10px; padding: 1px 7px; }
.vote-status-text { font-size: .84rem; color: var(--txt1); }

.seer-result { font-size: .74rem; font-weight: 700; padding: 1px 7px; border-radius: 10px; }
.seer-result.good { background: rgba(74,192,160,.2); color: var(--teal); }
.seer-result.bad  { background: rgba(224,112,80,.2); color: #e07050; }
.seer-history { display: flex; flex-direction: column; gap: 4px; margin-top: 4px; }
.seer-hist-title { font-size: .78rem; color: var(--txt2); font-weight: 600; text-transform: uppercase; margin-bottom: 4px; }
.seer-hist-row { font-size: .84rem; padding: 5px 10px; border-radius: var(--radius-sm); }
.seer-hist-row.good { background: rgba(74,192,160,.08); color: var(--teal); }
.seer-hist-row.bad  { background: rgba(224,112,80,.08); color: #e07050; }
.seer-inline { font-size: .72rem; margin-left: 4px; }
.seer-inline.good { color: var(--teal); }
.seer-inline.bad  { color: #e07050; }

/* ── Witch ───────────────────────────────────────────── */
.witch-killed-card { padding: 14px 16px; background: rgba(224,112,80,.07); border: 1px solid rgba(224,112,80,.3); border-radius: var(--radius); }
.witch-kill-label  { font-size: .8rem; color: var(--txt2); }
.witch-kill-name   { font-family: var(--serif); font-size: 1.1rem; font-weight: 700; color: #e07050; margin-top: 4px; }
.witch-action-section { display: flex; flex-direction: column; gap: 8px; }
.witch-poison-label   { font-size: .84rem; color: var(--txt1); margin-bottom: 4px; }
.witch-used           { font-size: .84rem; color: var(--txt2); font-style: italic; }

/* ── Day Announce ────────────────────────────────────── */
.day-dawn { text-align: center; padding: 16px 0 6px; }
.dawn-icon { font-size: 2.8rem; animation: glyph-float 4s ease-in-out infinite; }
.day-dawn h2 { font-family: var(--serif); font-size: 1.4rem; color: var(--gold2); margin-top: 6px; }

.announce-content { display: flex; flex-direction: column; gap: 12px; }

.announce-footer { display: flex; flex-direction: column; align-items: center; gap: 10px; margin-top: 6px; }

/* ── Discussion ──────────────────────────────────────── */
.discuss-header     { display: flex; align-items: center; justify-content: space-between; margin-bottom: 12px; }
.discuss-header h2  { font-family: var(--serif); font-size: 1.15rem; color: var(--txt0); }
.ready-count-badge  { font-size: .8rem; padding: 4px 12px; border-radius: 20px; background: var(--bg2); border: 1px solid var(--border2); color: var(--txt1); font-weight: 700; }

.discuss-player-list { display: flex; flex-direction: column; gap: 6px; flex: 1; }
.discuss-player-row  {
  display: flex; align-items: center; gap: 10px;
  padding: 10px 14px; background: var(--bg2); border: 1px solid var(--border);
  border-radius: var(--radius-sm); transition: border-color .2s;
}
.discuss-player-row.is-me { border-color: rgba(201,168,76,.4); }
.dp-avatar { width: 34px; height: 34px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: 700; font-size: .85rem; color: #000; flex-shrink: 0; }
.dp-name   { flex: 1; font-size: .88rem; color: var(--txt0); }
.btn-xs    { padding: 3px 10px; font-size: .76rem; border-radius: var(--radius-sm); }
.knight-btn { margin-left: auto; }

.discuss-actions { display: flex; flex-direction: column; gap: 8px; align-items: stretch; margin-top: 8px; }

/* ── Vote ────────────────────────────────────────────── */
.vote-header { text-align: center; margin-bottom: 12px; }
.vote-header h2   { font-family: var(--serif); font-size: 1.2rem; color: var(--txt0); }
.vote-hint        { font-size: .83rem; color: var(--txt1); margin: 4px 0; }
.vote-header .ready-count-badge { margin: 8px auto 0; display: inline-block; }

.vote-result-content { display: flex; flex-direction: column; align-items: center; gap: 14px; padding: 20px 0; }
.vote-result-footer { display: flex; align-items: center; gap: 10px; justify-content: center; color: var(--txt2); font-size: .84rem; margin-top: 12px; }

/* ── Special ─────────────────────────────────────────── */
.special-header { text-align: center; margin-bottom: 12px; }
.special-icon  { font-size: 2.5rem; }
.special-title { font-family: var(--serif); font-size: 1.1rem; color: var(--gold2); margin-top: 6px; }
.special-hint  { font-size: .84rem; color: var(--txt1); margin-top: 4px; }

/* ── End Screen ──────────────────────────────────────── */
.end-banner { text-align: center; padding: 24px 20px; border-radius: var(--radius); margin-bottom: 16px; }
.end-banner.wolf-win    { background: rgba(224,112,80,.1); border: 2px solid rgba(224,112,80,.4); }
.end-banner.village-win { background: rgba(74,192,160,.08); border: 2px solid rgba(74,192,160,.35); }
.end-banner.bomber-win  { background: rgba(201,168,76,.1); border: 2px solid rgba(201,168,76,.5); }
.end-icon   { font-size: 3.2rem; margin-bottom: 10px; animation: glyph-float 3s ease-in-out infinite; }
.end-title  { font-family: var(--serif); font-size: 1.6rem; font-weight: 900; }
.wolf-win .end-title    { color: #e07050; }
.village-win .end-title { color: var(--teal); }
.bomber-win .end-title  { color: var(--gold2); }
.end-reason { font-size: .88rem; color: var(--txt1); margin-top: 6px; }

/* ══════════════════════════════════════════════════════
   SPECTATOR LOBBY PANEL — room screen spectator view
══════════════════════════════════════════════════════ */
.spectator-lobby-panel {
  background: linear-gradient(135deg, rgba(139,92,246,.06) 0%, rgba(99,102,241,.04) 100%);
  border: 1.5px solid rgba(139,92,246,.2);
  border-radius: var(--radius); overflow: hidden;
}
.spec-lobby-header {
  display: flex; align-items: center; gap: 10px; flex-wrap: wrap;
  background: rgba(139,92,246,.1); border-bottom: 1px solid rgba(139,92,246,.2);
  padding: 12px 16px;
}
.spec-lobby-badge {
  font-size: .72rem; font-weight: 700; padding: 3px 10px; border-radius: 12px;
  background: rgba(139,92,246,.25); color: #c4b5fd;
  letter-spacing: .05em; text-transform: uppercase;
}
.spec-lobby-title { font-size: .95rem; font-weight: 600; color: var(--txt0); flex: 1; }
.spec-lobby-body  { padding: 12px 16px; display: flex; flex-direction: column; gap: 6px; }
.spec-lobby-row {
  display: flex; justify-content: space-between; align-items: center;
  font-size: .84rem; color: var(--txt1); padding: 4px 0;
  border-bottom: 1px solid rgba(255,255,255,.04);
}
.spec-lobby-row:last-child { border-bottom: none; }
.spec-lobby-roles { flex-wrap: wrap; gap: 4px; }
.slr-label { color: var(--txt2); font-size: .78rem; flex-shrink: 0; }
.spec-lobby-footer {
  padding: 10px 16px; border-top: 1px solid rgba(139,92,246,.15);
}
.btn-leave-spec {
  width: 100%; background: transparent; border: 1px solid rgba(255,255,255,.15);
  color: var(--txt1); font-size: .82rem; padding: 8px 16px;
  border-radius: var(--radius-sm); cursor: pointer; transition: all .2s;
}
.btn-leave-spec:hover { background: rgba(255,255,255,.06); color: var(--txt0); }

.role-reveal-list   { display: flex; flex-direction: column; gap: 6px; flex: 1; overflow-y: auto; }
.role-list-title    { font-size: .8rem; font-weight: 700; color: var(--txt2); text-transform: uppercase; letter-spacing: .06em; margin-bottom: 8px; }
.role-reveal-row {
  display: flex; align-items: center; gap: 10px;
  padding: 10px 14px; border-radius: var(--radius-sm);
  background: var(--bg2); border: 1px solid var(--border);
  transition: opacity .2s;
}
.role-reveal-row.dead { opacity: .55; }
.role-reveal-row.team-wolf    { border-left: 3px solid rgba(224,112,80,.6); }
.role-reveal-row.team-village { border-left: 3px solid rgba(74,192,160,.5); }
.rr-avatar { width: 32px; height: 32px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: 700; font-size: .82rem; color: #000; flex-shrink: 0; }
.rr-name   { flex: 1; font-size: .88rem; color: var(--txt0); }
.rr-role   { font-size: .82rem; color: var(--txt2); }
.rr-dead   { font-size: .74rem; color: #e07050; background: rgba(224,112,80,.1); border-radius: 10px; padding: 2px 8px; }
.rr-alive  { font-size: .74rem; color: var(--teal); background: rgba(74,192,160,.1); border-radius: 10px; padding: 2px 8px; }

.ww-end-footer { display: flex; justify-content: center; margin-top: 14px; }

/* ── Misc ────────────────────────────────────────────── */
.btn-danger   { background: #c0392b; color: #fff; }
.btn-danger:hover { background: #e74c3c; }
.btn-success  { background: #27ae60; color: #fff; }
.btn-success:hover { background: #2ecc71; }
.btn-success:disabled { opacity: .45; cursor: not-allowed; }

/* ══════════════════════════════════════════════════════
   HOME PAGE — redesigned
══════════════════════════════════════════════════════ */
.home-container {
  display: flex; flex-direction: column; align-items: center;
  justify-content: center; min-height: 100vh; padding: 24px 16px; gap: 24px;
}

/* Floating background emoji particles */
.home-particles { position: fixed; inset: 0; pointer-events: none; overflow: hidden; z-index: 0; }
.hp {
  position: absolute; font-size: clamp(1.2rem, 4vw, 2.2rem);
  opacity: .06; animation: hpFloat linear infinite;
  user-select: none;
}
.hp:nth-child(1){left:5%;top:15%;animation-duration:18s;animation-delay:0s}
.hp:nth-child(2){left:20%;top:70%;animation-duration:22s;animation-delay:3s}
.hp:nth-child(3){left:40%;top:30%;animation-duration:16s;animation-delay:6s}
.hp:nth-child(4){left:60%;top:80%;animation-duration:20s;animation-delay:1s}
.hp:nth-child(5){left:75%;top:20%;animation-duration:24s;animation-delay:4s}
.hp:nth-child(6){left:85%;top:55%;animation-duration:19s;animation-delay:8s}
.hp:nth-child(7){left:10%;top:50%;animation-duration:25s;animation-delay:2s}
.hp:nth-child(8){left:55%;top:10%;animation-duration:21s;animation-delay:7s}
@keyframes hpFloat { 0%{transform:translateY(0) rotate(0deg)} 50%{transform:translateY(-30px) rotate(15deg)} 100%{transform:translateY(0) rotate(0deg)} }

.home-hero { text-align: center; position: relative; z-index: 1; }

.home-logo-row {
  display: flex; align-items: center; justify-content: center;
  gap: 16px; margin-bottom: 20px;
}
.home-logo-glyph {
  font-size: 3.2rem; line-height: 1;
  animation: glyph-float 4s ease-in-out infinite;
}
.home-title {
  font-family: var(--serif); font-size: clamp(2rem, 6vw, 2.8rem);
  font-weight: 900; color: var(--txt0);
  letter-spacing: .02em; margin: 0;
  background: linear-gradient(135deg, var(--gold1), var(--gold2), #fde68a);
  -webkit-background-clip: text; -webkit-text-fill-color: transparent;
  background-clip: text;
}
.home-subtitle {
  font-size: .88rem; color: var(--txt1); margin: 4px 0 0; letter-spacing: .04em;
}

.home-game-chips {
  display: flex; gap: 10px; justify-content: center; flex-wrap: wrap; margin-top: 16px;
}
.hgc {
  display: flex; flex-direction: column; align-items: center; gap: 4px;
  background: rgba(255,255,255,.04); border: 1px solid var(--border);
  border-radius: 12px; padding: 10px 14px; min-width: 76px;
  transition: all .2s; cursor: default;
}
.hgc:hover { background: rgba(255,255,255,.07); border-color: var(--border2); transform: translateY(-2px); }
.hgc-wolf  { border-color: rgba(224,112,80,.25); }
.hgc-bomb  { border-color: rgba(201,168,76,.25); }
.hgc-icon  { font-size: 1.6rem; line-height: 1; }
.hgc-name  { font-size: .8rem; font-weight: 700; color: var(--txt0); }
.hgc-desc  { font-size: .68rem; color: var(--txt2); }

.home-card { position: relative; z-index: 1; width: 100%; max-width: 420px; }
.home-footer-note { font-size: .75rem; color: var(--txt2); text-align: center; position: relative; z-index: 1; }

/* ══════════════════════════════════════════════════════
   ROOM — maxPlayers select + spectator toggle
══════════════════════════════════════════════════════ */
.form-inline-row {
  display: flex; align-items: center; justify-content: space-between;
  gap: 12px; padding: 8px 0;
  border-bottom: 1px solid var(--border); margin-bottom: 12px;
}
.form-inline-row label { font-size: .84rem; color: var(--txt1); margin: 0; font-weight: 500; }
.select-compact {
  background: var(--bg2); border: 1px solid var(--border2); color: var(--txt0);
  border-radius: var(--radius-sm); padding: 5px 10px; font-size: .84rem;
  cursor: pointer; appearance: auto;
}
.select-compact:focus { outline: 2px solid rgba(201,168,76,.4); }

.spec-toggle-wrap {
  padding: 10px 14px; border-top: 1px solid var(--border); margin-top: 4px;
}
.spec-toggle-btn {
  width: 100%; font-size: .82rem;
  transition: all .2s;
}
.spec-toggle-btn.active-spec {
  background: rgba(139,92,246,.15); border-color: rgba(139,92,246,.4);
  color: #c4b5fd;
}
.player-item.is-spectator { opacity: .65; }

/* ══════════════════════════════════════════════════════
   END SCREEN — death cause in role reveal list
══════════════════════════════════════════════════════ */
.rr-section-label {
  font-size: .72rem; font-weight: 700; color: var(--txt2);
  text-transform: uppercase; letter-spacing: .07em;
  padding: 8px 4px 4px; margin-top: 6px;
}
.rr-dead-label { color: rgba(248,113,113,.5); }
.rr-empty { font-size: .82rem; color: var(--txt2); padding: 6px 4px; }

.rr-row {
  display: grid; grid-template-columns: auto 1fr auto auto;
  align-items: center; gap: 10px;
  padding: 10px 14px; border-radius: var(--radius-sm);
  background: var(--bg2); border: 1px solid var(--border);
  margin-bottom: 6px;
}
.rr-row.rr-dead-row { opacity: .6; border-left: 3px solid rgba(248,113,113,.4); }
.rr-row.team-wolf   { border-left: 3px solid rgba(224,112,80,.6); }
.rr-row.team-village:not(.rr-dead-row) { border-left: 3px solid rgba(74,192,160,.5); }
.rr-row.rr-dead-row.team-wolf { border-left: 3px solid rgba(224,112,80,.3); }
.rr-avatar-wrap { position: relative; flex-shrink: 0; }
.rr-avatar { width: 34px; height: 34px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: 700; font-size: .82rem; color: #000; }
.rr-skull { position: absolute; bottom: -3px; right: -3px; font-size: .75rem; line-height: 1; }
.rr-info { min-width: 0; }
.rr-name { font-size: .88rem; font-weight: 600; color: var(--txt0); }
.rr-cause { font-size: .72rem; color: var(--txt2); margin-top: 2px; }
.rr-role-badge {
  font-size: .76rem; padding: 3px 8px; border-radius: 10px;
  white-space: nowrap; font-weight: 600;
}
.team-badge-wolf    { background: rgba(224,112,80,.15); color: #e07050; }
.team-badge-village { background: rgba(74,192,160,.12); color: var(--teal); }
.team-badge-bomber  { background: rgba(201,168,76,.15); color: var(--gold2); }
.rr-status { text-align: right; }
.rr-dead  { font-size: .74rem; color: #f87171; background: rgba(248,113,113,.1); border-radius: 10px; padding: 2px 8px; }
.rr-alive { font-size: .74rem; color: var(--teal); background: rgba(74,192,160,.1); border-radius: 10px; padding: 2px 8px; }

/* ══════════════════════════════════════════════════════
   SPECTATOR ROLE REVEAL — fixed toggle
══════════════════════════════════════════════════════ */
.spec-role-hint { color: rgba(139,92,246,.55); font-size: .76rem; font-style: italic; cursor: pointer; }
.spec-role-text { font-weight: 600; font-size: .82rem; cursor: pointer; }
.spec-role-text.team-wolf    { color: #e07050; }
.spec-role-text.team-village { color: var(--teal); }
.spec-role-text.team-bomber  { color: var(--gold2); }
.spec-role-cell { cursor: pointer; user-select: none; padding: 4px 0; }
.spec-row { cursor: default; }  /* row itself not clickable, only the role cell */

/* ══════════════════════════════════════════════════════
   VOTE TIMER & LOCK SYSTEM
══════════════════════════════════════════════════════ */
.vote-header-row { display: flex; align-items: center; justify-content: space-between; margin: 8px 0; }
.vote-countdown {
  font-family: var(--serif); font-size: 1.05rem; font-weight: 700;
  color: var(--teal); border: 1.5px solid var(--teal);
  padding: 4px 12px; border-radius: 20px; letter-spacing: .04em;
  transition: color .3s, border-color .3s;
}
.vote-countdown.urgent { color: #e07050; border-color: #e07050; animation: pulse 1s infinite; }
.vote-timer-bar-wrap {
  height: 3px; background: rgba(255,255,255,.08); border-radius: 2px;
  margin: 0 0 10px; overflow: hidden;
}
.vote-timer-bar {
  height: 100%; width: 100%; border-radius: 2px;
  background: linear-gradient(90deg, #e07050, var(--teal));
  transition: width .9s linear;
}

.vote-lock-row { display: flex; justify-content: center; margin-top: 12px; }
.vote-lock-btn { min-width: 200px; }

/* Locked chip style */
.vote-chip.locked {
  border-color: var(--teal) !important;
  box-shadow: 0 0 0 2px rgba(74,192,160,.3);
  pointer-events: none;
}

/* ══════════════════════════════════════════════════════
   DISCUSS READY INDICATOR
══════════════════════════════════════════════════════ */
.dp-ready { font-size: .72rem; color: var(--teal); margin-left: auto; margin-right: 8px; }
.discuss-player-row { position: relative; }

/* ══════════════════════════════════════════════════════
   PASSIVE NIGHT PANEL & NIGHT TOY
══════════════════════════════════════════════════════ */
.night-toy-wrap {
  display: flex; justify-content: center; margin: 16px 0 8px;
}
.night-toy {
  width: 200px; height: 140px; border-radius: 16px;
  background: linear-gradient(180deg, #0a0d1a 0%, #141830 100%);
  border: 1px solid rgba(139,92,246,.2); position: relative; overflow: hidden;
  cursor: pointer; user-select: none;
}
.toy-scene { position: absolute; inset: 0; }
.toy-star {
  position: absolute; font-size: .6rem; color: rgba(255,255,255,.5);
  animation: starTwinkle 2s ease-in-out infinite;
}
.ts1{top:12%;left:18%;animation-delay:0s}
.ts2{top:20%;left:72%;animation-delay:.5s}
.ts3{top:60%;left:30%;animation-delay:1s}
.ts4{top:15%;left:50%;animation-delay:1.5s}
@keyframes starTwinkle { 0%,100%{opacity:.3} 50%{opacity:1} }

.toy-moon {
  position: absolute; font-size: 2.2rem; top: 24%; left: 50%;
  transform: translateX(-50%); cursor: pointer;
  transition: transform .3s cubic-bezier(.34,1.56,.64,1);
  filter: drop-shadow(0 0 8px rgba(255,220,100,.4));
}
.toy-moon:hover { transform: translateX(-50%) scale(1.15); }

.toy-cloud {
  position: absolute; font-size: .9rem; color: rgba(255,255,255,.15);
  animation: cloudDrift 8s linear infinite;
}
.tc1{top:55%;left:-10%;animation-delay:0s}
.tc2{top:40%;left:-10%;animation-delay:4s}
@keyframes cloudDrift { from{transform:translateX(0)} to{transform:translateX(220px)} }

.toy-msg {
  position: absolute; bottom: 10px; left: 0; right: 0;
  text-align: center; font-size: .7rem; color: rgba(255,255,255,.45);
  letter-spacing: .04em;
}
.toy-spark {
  position: absolute; font-size: .9rem;
  animation: sparkPop .7s ease forwards; pointer-events: none;
}
@keyframes sparkPop {
  0%  { opacity: 1; transform: scale(0) translateY(0); }
  60% { opacity: 1; transform: scale(1.3) translateY(-16px); }
  100%{ opacity: 0; transform: scale(1) translateY(-28px); }
}


/* ══════════════════════════════════════════════════════
   HOME PAGE — LUXURY REDESIGN
══════════════════════════════════════════════════════ */

/* Page centre wrapper */
.home-center {
  position: relative; z-index: 1;
  min-height: 100vh;
  display: flex; flex-direction: column; align-items: center; justify-content: center;
  padding: 48px 24px 56px; gap: 0;
  text-align: center;
}
.home-center::before {
  content: '';
  position: absolute; top: 0; left: 50%; transform: translateX(-50%);
  width: 700px; height: 450px; pointer-events: none;
  background: radial-gradient(ellipse at 50% 20%, rgba(74,192,160,.1) 0%, rgba(201,168,76,.06) 40%, transparent 70%);
  z-index: -1;
}

/* ── Hero block ─────────────────── */
.home-hero-block { text-align: center; margin-bottom: 38px; }

.home-crown-ring {
  width: 100px; height: 100px; border-radius: 50%;
  background: radial-gradient(circle at 40% 35%, rgba(255,255,255,.07) 0%, rgba(201,168,76,.03) 100%);
  border: 1px solid rgba(201,168,76,.3);
  display: flex; align-items: center; justify-content: center;
  margin: 0 auto 26px;
  box-shadow: 0 0 0 10px rgba(201,168,76,.04), 0 0 0 20px rgba(201,168,76,.02), 0 0 70px rgba(201,168,76,.2), 0 0 140px rgba(74,192,160,.1);
  animation: crownPulse 5s ease-in-out infinite;
}
@keyframes crownPulse {
  0%,100%{ box-shadow: 0 0 0 10px rgba(201,168,76,.04), 0 0 0 20px rgba(201,168,76,.02), 0 0 70px rgba(201,168,76,.2), 0 0 140px rgba(74,192,160,.1); }
  50%    { box-shadow: 0 0 0 10px rgba(201,168,76,.07), 0 0 0 20px rgba(201,168,76,.04), 0 0 90px rgba(201,168,76,.3), 0 0 180px rgba(74,192,160,.15); }
}
.home-crown-icon { font-size: 3rem; line-height: 1; filter: drop-shadow(0 0 14px rgba(201,168,76,.55)); }

.home-main-title {
  font-family: var(--serif);
  font-size: clamp(2.8rem, 9vw, 4.6rem);
  font-weight: 900; letter-spacing: .1em; margin: 0 0 10px; line-height: 1.05;
  background: linear-gradient(160deg, #d4a820 0%, #f5e88a 30%, #fffacd 55%, #e8c040 75%, #c8960a 100%);
  -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text;
  filter: drop-shadow(0 4px 28px rgba(201,168,76,.3));
}
.home-main-sub {
  font-size: .6rem; letter-spacing: .36em; color: rgba(201,168,76,.4);
  text-transform: uppercase; margin: 0 0 26px; font-weight: 600;
}
.home-title-divider {
  display: flex; align-items: center; justify-content: center; gap: 16px;
}
.htd-line { width: 72px; height: 1px; background: linear-gradient(90deg, transparent, rgba(201,168,76,.3), transparent); }
.htd-gem  { font-size: .55rem; color: rgba(201,168,76,.5); letter-spacing: 8px; }

/* ── Mode pills ─────────────────── */
.home-modes-row {
  display: flex; gap: 14px; justify-content: center; flex-wrap: wrap;
  margin-bottom: 42px;
}
.home-mode-pill {
  display: flex; align-items: center; gap: 16px;
  padding: 18px 24px; border-radius: 18px; min-width: 185px;
  background: rgba(255,255,255,.03);
  border: 1px solid rgba(255,255,255,.07);
  box-shadow: 0 8px 40px rgba(0,0,0,.3), inset 0 1px 0 rgba(255,255,255,.06);
  transition: border-color .3s, background .3s, transform .3s, box-shadow .3s;
  cursor: default; text-align: left;
}
.home-mode-pill:hover {
  background: rgba(255,255,255,.055); border-color: rgba(74,192,160,.22);
  transform: translateY(-4px);
  box-shadow: 0 20px 60px rgba(0,0,0,.35), 0 0 30px rgba(74,192,160,.07), inset 0 1px 0 rgba(255,255,255,.09);
}
.home-mode-pill.hmp-wolf { border-color: rgba(224,112,80,.1); }
.home-mode-pill.hmp-wolf:hover { border-color: rgba(224,112,80,.3); box-shadow: 0 20px 60px rgba(0,0,0,.35), 0 0 30px rgba(224,112,80,.09), inset 0 1px 0 rgba(255,255,255,.07); }
.hmp-icon { font-size: 2.2rem; line-height: 1; flex-shrink: 0; }
.hmp-name { font-size: 1rem; font-weight: 800; color: var(--txt0); letter-spacing: .03em; }
.hmp-desc { font-size: .72rem; color: var(--txt2); margin-top: 4px; }

/* ── Form card ───────────────────── */
.home-card-wrap {
  width: 100%; max-width: 400px;
  display: flex; flex-direction: column; align-items: center; gap: 16px;
}
.home-card {
  width: 100%; padding: 36px 30px;
  border-radius: 26px;
  background: linear-gradient(145deg, rgba(255,255,255,.055) 0%, rgba(255,255,255,.022) 100%);
  border: 1px solid rgba(255,255,255,.1);
  box-shadow: 0 40px 100px rgba(0,0,0,.6), 0 16px 40px rgba(0,0,0,.35), 0 0 0 1px rgba(255,255,255,.045) inset, 0 1px 0 rgba(255,255,255,.1) inset;
  backdrop-filter: blur(24px);
}
.home-card-section { margin-bottom: 22px; }
.home-field-label {
  display: block; font-size: .62rem; font-weight: 700; letter-spacing: .18em;
  text-transform: uppercase; color: var(--txt2); margin-bottom: 10px;
}
.home-field {
  width: 100%; box-sizing: border-box;
  background: rgba(0,0,0,.22); border: 1px solid rgba(255,255,255,.1);
  color: var(--txt0); font-size: .97rem; padding: 14px 16px;
  border-radius: 13px; outline: none; transition: border-color .22s, box-shadow .22s;
  font-family: var(--sans);
}
.home-field:focus { border-color: rgba(74,192,160,.5); box-shadow: 0 0 0 3px rgba(74,192,160,.13), 0 0 24px rgba(74,192,160,.07); }
.home-field::placeholder { color: var(--txt2); opacity: .55; }
.home-code-field { letter-spacing: .24em; font-weight: 700; text-align: center; font-size: 1.06rem; }

.home-btn-primary {
  display: block; width: 100%; padding: 16px 0; border-radius: 15px;
  background: linear-gradient(135deg, #4ec4a4 0%, #3aab92 60%, #2b9078 100%);
  color: #081a14; font-size: .97rem; font-weight: 900; border: none;
  cursor: pointer; letter-spacing: .08em;
  box-shadow: 0 8px 28px rgba(74,192,160,.45), 0 2px 8px rgba(0,0,0,.3);
  transition: transform .15s, box-shadow .18s, filter .15s;
  font-family: var(--sans);
}
.home-btn-primary:hover { transform: translateY(-2px); box-shadow: 0 14px 42px rgba(74,192,160,.6), 0 4px 14px rgba(0,0,0,.32); filter: brightness(1.07); }
.home-btn-primary:active { transform: translateY(0); filter: brightness(.96); }

.home-sep {
  display: flex; align-items: center; gap: 14px;
  font-size: .66rem; color: var(--txt2); margin: 22px 0; letter-spacing: .1em;
}
.home-sep::before,.home-sep::after { content:''; flex:1; height:1px; background: linear-gradient(90deg, transparent, rgba(255,255,255,.08), transparent); }

.home-join-row { display: flex; gap: 10px; }
.home-btn-secondary {
  flex-shrink: 0; padding: 14px 20px; border-radius: 13px;
  background: rgba(255,255,255,.055); border: 1px solid rgba(255,255,255,.11);
  color: var(--txt0); font-size: .9rem; font-weight: 700;
  cursor: pointer; letter-spacing: .04em;
  transition: all .18s; white-space: nowrap;
  font-family: var(--sans);
  box-shadow: 0 2px 12px rgba(0,0,0,.22);
}
.home-btn-secondary:hover { background: rgba(255,255,255,.1); border-color: rgba(255,255,255,.2); box-shadow: 0 6px 20px rgba(0,0,0,.3); }
.home-fine-print { font-size: .62rem; color: var(--txt2); opacity: .35; text-align: center; letter-spacing: .08em; }

/* ══════════════════════════════════════════════════════
   DEAD PLAYER OVERLAY
══════════════════════════════════════════════════════ */
.ww-dead-overlay {
  border-color: rgba(248,113,113,.25) !important;
  background: linear-gradient(135deg, rgba(248,113,113,.07) 0%, rgba(127,29,29,.06) 100%) !important;
}
.dead-player-header {
  display: flex; flex-direction: column; align-items: center; gap: 10px;
  padding: 24px 20px 20px; text-align: center;
  border-bottom: 1px solid rgba(248,113,113,.15);
}
.dead-skull-big { font-size: 2.8rem; animation: floatPetal 3s ease-in-out infinite; }
.dead-title { font-family: var(--serif); font-size: 1.5rem; font-weight: 700; color: #f87171; margin: 0; }
.dead-cause-row { display: flex; align-items: center; gap: 8px; flex-wrap: wrap; justify-content: center; margin-top: 2px; }
.dead-cause-label { font-size: .74rem; color: var(--txt2); letter-spacing: .06em; text-transform: uppercase; }
.dead-cause-text { font-size: .85rem; font-weight: 600; color: #fca5a5; background: rgba(248,113,113,.12); padding: 3px 10px; border-radius: 10px; }
.dead-role-row { display: flex; justify-content: center; }
.dead-role-badge { font-size: .82rem; font-weight: 700; padding: 4px 14px; border-radius: 12px; }

/* ══════════════════════════════════════════════════════
   HOST SPECTATOR EXIT BAR
══════════════════════════════════════════════════════ */
.host-spec-exit-bar {
  display: flex; align-items: center; justify-content: space-between; gap: 12px;
  padding: 12px 16px; margin-bottom: 12px;
  background: rgba(139,92,246,.1); border: 1px solid rgba(139,92,246,.25);
  border-radius: var(--radius);
}
.host-spec-exit-bar .spec-info { font-size: .82rem; color: #c4b5fd; }
.btn-host-leave-spec {
  background: rgba(255,255,255,.08); border: 1px solid rgba(255,255,255,.15);
  color: var(--txt0); font-size: .8rem; padding: 6px 14px; border-radius: 8px;
  cursor: pointer; white-space: nowrap; transition: all .2s;
}
.btn-host-leave-spec:hover { background: rgba(255,255,255,.14); border-color: rgba(255,255,255,.25); }

/* ══════════════════════════════════════════════════════
   DEAD HOST CONTROL BAR
══════════════════════════════════════════════════════ */
.dead-host-bar {
  position: sticky; top: 0; z-index: 10;
  display: flex; align-items: center; justify-content: center; gap: 10px;
  padding: 8px 16px;
  background: linear-gradient(90deg, rgba(139,92,246,.2), rgba(74,192,160,.2));
  border-bottom: 1px solid rgba(139,92,246,.3);
  backdrop-filter: blur(8px);
}
.dead-host-btn { font-size: .82rem; padding: 6px 16px; border-radius: 8px; }

/* ══════════════════════════════════════════════════════
   WOLFKING DEAD SECRET SHOT PANEL
══════════════════════════════════════════════════════ */
.dead-wk-panel {
  margin: 0 0 14px;
  background: linear-gradient(135deg, rgba(180,30,30,.15), rgba(255,120,50,.08));
  border: 1.5px solid rgba(220,80,60,.35);
  border-radius: 14px; padding: 14px 16px;
}
.dead-wk-header { display: flex; align-items: center; gap: 8px; margin-bottom: 6px; }
.dead-wk-icon { font-size: 1.4rem; }
.dead-wk-title { font-family: var(--serif); font-size: 1rem; font-weight: 700; color: #fca5a5; }
.dead-wk-hint { font-size: .75rem; color: var(--txt2); margin: 0 0 10px; }
.dead-wk-chosen { font-size: .78rem; color: #4ac0a0; margin-top: 8px; }

/* ══════════════════════════════════════════════════════
   KNIGHT REVEAL BUTTON & BADGE
══════════════════════════════════════════════════════ */
.btn-warning { background: linear-gradient(135deg, #d97706, #f59e0b); color: #fff; border: none; }
.btn-warning:hover { filter: brightness(1.1); transform: translateY(-1px); }
.knight-revealed-badge {
  padding: 8px 14px; border-radius: 10px;
  background: rgba(245,158,11,.12); border: 1px solid rgba(245,158,11,.3);
  color: #fbbf24; font-size: .82rem; text-align: center;
}
.selected-btn { color: var(--teal) !important; border-color: var(--teal) !important; }
.hunter-day-btn { font-size: .7rem; padding: 3px 8px; margin-left: 4px; }

/* ══════════════════════════════════════════════════════
   BOMB TOY
══════════════════════════════════════════════════════ */
.toy-bomb {
  position: absolute; font-size: 2.4rem; top: 22%; left: 50%;
  transform: translateX(-50%); cursor: pointer;
  transition: transform .2s cubic-bezier(.34,1.56,.64,1);
  filter: drop-shadow(0 0 8px rgba(255,100,50,.4));
}
.toy-bomb:hover { transform: translateX(-50%) scale(1.12); }
.toy-fuse {
  position: absolute; font-size: .9rem; color: #fbbf24;
  top: 15%; left: 62%;
  animation: fuseBurn 1.2s ease-in-out infinite alternate;
}
@keyframes fuseBurn { from{opacity:.4; transform:rotate(-10deg)} to{opacity:1; transform:rotate(10deg)} }

/* ══════════════════════════════════════════════════════
   KNIGHT DUEL MINI-GAME
══════════════════════════════════════════════════════ */
.toy-knight-game { width: 100%; height: 100%; display: flex; flex-direction: column; align-items: center; gap: 4px; padding: 6px; box-sizing: border-box; }
.knight-arena {
  position: relative; width: 100%; flex: 1;
  border-radius: 10px; background: rgba(0,0,0,.25);
  border: 1px solid rgba(245,158,11,.2); overflow: hidden;
}
.knight-hero {
  position: absolute; bottom: 8px; left: 50%; transform: translateX(-50%);
  font-size: 1.8rem; cursor: default; transition: all .15s;
}
.knight-attacker {
  position: absolute; font-size: 1.4rem; cursor: pointer;
  transition: opacity .2s, transform .2s;
  animation: attackWobble .4s ease infinite alternate;
}
@keyframes attackWobble { from{transform: scale(1.2) rotate(-10deg)} to{transform: scale(1.4) rotate(10deg)} }
.knight-score-row { display: flex; gap: 14px; font-size: .72rem; }
.knight-score { color: #4ac0a0; font-weight: 700; }
.knight-miss  { color: #f87171; font-weight: 700; }

/* ══════════════════════════════════════════════════════
   VILLAGER SHEEP COUNTING MINI-GAME
══════════════════════════════════════════════════════ */
.toy-sheep-game { width: 100%; height: 100%; display: flex; flex-direction: column; align-items: center; gap: 4px; padding: 6px; box-sizing: border-box; }
.sheep-field {
  position: relative; width: 100%; flex: 1;
  background: linear-gradient(180deg, rgba(74,192,160,.08) 0%, rgba(0,0,0,.1) 100%);
  border-radius: 10px; border: 1px solid rgba(74,192,160,.15); overflow: hidden;
  display: flex; align-items: flex-end;
}
.sheep-fence { font-size: .6rem; color: rgba(255,255,255,.25); width: 100%; text-align: center; padding-bottom: 4px; letter-spacing: 4px; }
.sheep-counter { font-size: .85rem; color: var(--txt1); font-family: var(--serif); }
.sheep-jump-btn {
  background: rgba(74,192,160,.15); border: 1px solid rgba(74,192,160,.3);
  color: var(--teal); padding: 4px 16px; border-radius: 8px;
  font-size: .8rem; cursor: pointer; transition: all .15s;
}
.sheep-jump-btn:hover:not(:disabled) { background: rgba(74,192,160,.25); transform: translateY(-1px); }
.sheep-jump-btn:disabled { opacity: .5; cursor: default; }
.toy-jumping-sheep {
  position: absolute; font-size: 1.2rem; bottom: 12px;
  animation: sheepJump .9s ease forwards;
  pointer-events: none;
}
@keyframes sheepJump {
  0%   { transform: translateX(0) translateY(0) scaleX(1); opacity: 1; }
  35%  { transform: translateX(60px) translateY(-40px) scaleX(1); }
  65%  { transform: translateX(120px) translateY(-20px) scaleX(1); }
  100% { transform: translateX(200px) translateY(0) scaleX(-1); opacity: 0; }
}

/* ══════════════════════════════════════════════════════
   KNIGHT PUBLIC REVEAL / CHALLENGE BANNER
══════════════════════════════════════════════════════ */
.knight-public-banner {
  display: flex; align-items: center; gap: 10px;
  padding: 10px 14px; border-radius: 12px; margin-bottom: 10px;
  font-size: .85rem; animation: knightBannerIn .4s cubic-bezier(.34,1.56,.64,1);
}
@keyframes knightBannerIn { from{opacity:0;transform:translateY(-8px) scale(.96)} to{opacity:1;transform:none} }
.knight-public-banner.hidden { display: none; }
.knight-banner-reveal  { background: rgba(245,158,11,.12); border: 1.5px solid rgba(245,158,11,.35); }
.knight-banner-hit     { background: rgba(74,222,128,.1);  border: 1.5px solid rgba(74,222,128,.4); }
.knight-banner-miss    { background: rgba(248,113,113,.1); border: 1.5px solid rgba(248,113,113,.35); }
.knight-banner-icon    { font-size: 1.3rem; flex-shrink: 0; }
.knight-banner-text    { color: var(--txt0); line-height: 1.4; }
.knight-banner-text strong { color: #fbbf24; }
.knight-banner-hit .knight-banner-text strong  { color: #4ade80; }
.knight-banner-miss .knight-banner-text strong { color: #f87171; }

/* Knight badge inline in player list */
.dp-knight-badge {
  display: inline-block; font-size: .68rem; font-weight: 700;
  color: #fbbf24; background: rgba(245,158,11,.15);
  border: 1px solid rgba(245,158,11,.3); border-radius: 6px;
  padding: 1px 6px; margin-left: 4px; vertical-align: middle;
}

/* ══════════════════════════════════════════════════════
   HUNTER DEAD OVERLAY SHOOT PANEL
══════════════════════════════════════════════════════ */
.dead-hunter-panel {
  margin: 0 0 12px;
  background: linear-gradient(135deg, rgba(245,158,11,.12), rgba(20,19,25,.9));
  border: 1.5px solid rgba(245,158,11,.4); border-radius: var(--radius);
  padding: 14px 16px;
  animation: knightBannerIn .4s cubic-bezier(.34,1.56,.64,1);
}
.dead-hunter-panel.dead-hunter-done {
  display: flex; align-items: center; gap: 10px;
  background: rgba(74,192,160,.08); border-color: rgba(74,192,160,.3);
}
.dead-hunter-header { display: flex; align-items: center; gap: 10px; margin-bottom: 8px; }
.dead-hunter-icon   { font-size: 1.4rem; }
.dead-hunter-title  { font-size: 1rem; font-weight: 700; color: #fbbf24; }
.dead-hunter-hint   { font-size: .82rem; color: var(--txt1); margin-bottom: 10px; }
.dead-hunter-sub    { font-size: .72rem; color: var(--txt2); margin-top: 8px; text-align: center; }

/* ══════════════════════════════════════════════════════
   HUNTER NIGHT TOY - MOVING TARGET RANGE
══════════════════════════════════════════════════════ */
.toy-hunter-game { width: 100%; height: 100%; display: flex; flex-direction: column; align-items: center; gap: 4px; padding: 6px; box-sizing: border-box; }
.hunter-range {
  position: relative; width: 100%; flex: 1;
  background: rgba(0,0,0,.3); border-radius: 10px;
  border: 1px solid rgba(245,158,11,.15); overflow: hidden; cursor: crosshair;
}
.hunter-target {
  position: absolute; font-size: 1.6rem;
  top: 30%; left: 40%;
  transition: left .35s cubic-bezier(.4,0,.2,1), top .35s cubic-bezier(.4,0,.2,1), transform .2s;
  cursor: pointer; pointer-events: none; user-select: none;
}
.hunter-stats { display: flex; gap: 16px; font-size: .72rem; }
.hunter-hits   { color: #4ade80; font-weight: 700; }
.hunter-misses { color: #f87171; font-weight: 700; }

/* ══════════════════════════════════════════════════════
   VILLAGER NIGHT TOY - SURVIVAL DIARY
══════════════════════════════════════════════════════ */
.toy-diary-game { width: 100%; height: 100%; display: flex; flex-direction: column; align-items: center; gap: 4px; padding: 6px; box-sizing: border-box; }
.diary-cover {
  width: 100%; flex: 1;
  background: linear-gradient(135deg, rgba(201,168,76,.06), rgba(0,0,0,.2));
  border: 1px solid rgba(201,168,76,.15); border-radius: 10px;
  padding: 6px 10px; overflow: hidden;
  display: flex; flex-direction: column;
}
.diary-title { font-size: .7rem; font-weight: 700; color: var(--gold); margin-bottom: 4px; text-align: center; }
.diary-lines { flex: 1; overflow-y: auto; display: flex; flex-direction: column; gap: 2px; }
.diary-line  {
  font-size: .65rem; color: var(--txt1); font-family: var(--serif);
  padding: 1px 0; border-bottom: 1px dashed rgba(255,255,255,.04);
  animation: seg-in .3s ease forwards;
}
.diary-write-btn {
  background: rgba(201,168,76,.12); border: 1px solid rgba(201,168,76,.25);
  color: var(--gold2); padding: 4px 14px; border-radius: 8px;
  font-size: .75rem; cursor: pointer; transition: all .15s;
}
.diary-write-btn:hover:not(:disabled) { background: rgba(201,168,76,.22); transform: translateY(-1px); }
.diary-write-btn:disabled { opacity: .5; cursor: default; }

/* ══════════════════════════════════════════════════════
   STORY RELAY - UNLOCK BUTTON IN WAITING PANEL
══════════════════════════════════════════════════════ */
.btn-unlock-locked {
  width: 100%; margin-top: 10px;
  font-size: .8rem; padding: 8px 0;
  border-top: 1px dashed rgba(255,255,255,.1);
  border-radius: 0 0 var(--radius) var(--radius);
}

/* ══════════════════════════════════════════════════════
   SPECIAL PANEL — HUNTER & WOLFKING PUBLIC ABILITY
══════════════════════════════════════════════════════ */
.special-stage {
  display: flex; flex-direction: column; align-items: center;
  gap: 14px; padding: 20px 16px; border-radius: var(--radius);
  border: 1.5px solid; animation: specialIn .5s cubic-bezier(.34,1.56,.64,1);
  min-height: 200px;
}
@keyframes specialIn { from{opacity:0;transform:scale(.92) translateY(10px)} to{opacity:1;transform:none} }

.special-hunter-bg {
  background: linear-gradient(135deg, rgba(245,158,11,.12), rgba(20,19,25,.95));
  border-color: rgba(245,158,11,.4);
  box-shadow: 0 0 40px rgba(245,158,11,.08);
}
.special-wolfking-bg {
  background: linear-gradient(135deg, rgba(220,38,38,.12), rgba(20,19,25,.95));
  border-color: rgba(220,38,38,.35);
  box-shadow: 0 0 40px rgba(220,38,38,.08);
}

/* Actor reveal row */
.special-reveal-row {
  display: flex; align-items: center; gap: 14px; width: 100%;
  background: rgba(0,0,0,.2); border-radius: var(--radius-sm); padding: 12px 16px;
}
.special-actor-avatar {
  width: 52px; height: 52px; border-radius: 50%;
  display: flex; align-items: center; justify-content: center;
  font-size: 1.3rem; font-weight: 900; color: #fff; flex-shrink: 0;
  border: 2px solid rgba(255,255,255,.15);
  animation: avatarPulse 2s ease-in-out infinite;
}
@keyframes avatarPulse { 0%,100%{box-shadow:0 0 0 0 rgba(255,255,255,.1)} 50%{box-shadow:0 0 0 8px rgba(255,255,255,0)} }
.special-reveal-info { flex: 1; }
.special-badge {
  font-size: .68rem; font-weight: 900; text-transform: uppercase; letter-spacing: 1.5px;
  padding: 2px 8px; border-radius: 20px; display: inline-block; margin-bottom: 4px;
}
.special-hunter-bg .special-badge  { background: rgba(245,158,11,.25); color: #fbbf24; }
.special-wolfking-bg .special-badge { background: rgba(220,38,38,.25); color: #fca5a5; }
.special-actor-name { font-size: 1rem; font-weight: 700; color: var(--txt0); }
.special-role-icon  { font-size: 2rem; flex-shrink: 0; animation: float 2s ease-in-out infinite; }

/* Headlines */
.special-headline {
  font-family: var(--serif); font-size: 1.15rem; font-weight: 700;
  color: var(--txt0); text-align: center; line-height: 1.4;
}
.special-subline { font-size: .82rem; color: var(--txt1); text-align: center; }

/* Target grid */
.special-target-grid {
  display: flex; flex-wrap: wrap; gap: 10px; justify-content: center; width: 100%;
}
.special-target-chip {
  display: flex; align-items: center; gap: 8px;
  background: rgba(255,255,255,.06); border: 1.5px solid rgba(255,255,255,.1);
  border-radius: var(--radius-sm); padding: 10px 14px;
  cursor: pointer; transition: all .15s; min-width: 100px;
}
.special-hunter-bg  .special-target-chip:hover { border-color: rgba(245,158,11,.5); background: rgba(245,158,11,.1); transform: translateY(-2px); }
.special-wolfking-bg .special-target-chip:hover { border-color: rgba(220,38,38,.5); background: rgba(220,38,38,.1); transform: translateY(-2px); }
.special-target-avatar {
  width: 32px; height: 32px; border-radius: 50%; flex-shrink: 0;
  display: flex; align-items: center; justify-content: center;
  font-size: .85rem; font-weight: 700; color: #fff;
}
.special-target-name  { font-size: .85rem; font-weight: 600; color: var(--txt0); flex: 1; }
.special-target-arrow { font-size: .75rem; color: var(--txt2); }
.special-must-choose  { font-size: .72rem; color: var(--txt2); text-align: center; }

/* Waiting scene */
.special-watching {
  display: flex; flex-direction: column; align-items: center; gap: 10px; padding: 16px 0;
}
.special-watch-icon  { font-size: 2.5rem; animation: float 2s ease-in-out infinite; }
.special-watch-label { font-size: .85rem; color: var(--txt1); }
.special-dots        { display: flex; gap: 6px; }
.special-dots span {
  width: 7px; height: 7px; border-radius: 50%; background: var(--txt2);
  animation: dotBounce 1.2s ease-in-out infinite;
}
.special-dots span:nth-child(2) { animation-delay: .2s; }
.special-dots span:nth-child(3) { animation-delay: .4s; }

/* ══════════════════════════════════════════════════════
   VILLAGER NIGHT TOY — STAR CATCH GAME
══════════════════════════════════════════════════════ */
.toy-star-game { width: 100%; height: 100%; display: flex; flex-direction: column; padding: 4px; box-sizing: border-box; }
.star-sky {
  flex: 1; position: relative; overflow: hidden;
  background: radial-gradient(ellipse at 50% 0%, rgba(155,133,232,.08) 0%, transparent 70%);
  border-radius: 10px 10px 0 0; border: 1px solid rgba(155,133,232,.12);
  border-bottom: none; cursor: crosshair;
}
.star-ground {
  text-align: center; padding: 2px 0;
  border: 1px solid rgba(155,133,232,.12); border-top: 2px solid rgba(155,133,232,.3);
  background: rgba(155,133,232,.04); border-radius: 0 0 10px 10px;
}
.star-ground-line { font-size: .6rem; color: rgba(155,133,232,.4); letter-spacing: 2px; }
.star-hud { display: flex; gap: 14px; justify-content: center; padding: 3px 0; font-size: .72rem; font-weight: 700; }
.star-caught { color: #fbbf24; }
.star-missed { color: var(--txt2); }

.falling-star {
  position: absolute; top: -30px; font-size: 1.3rem;
  animation: starFall linear forwards;
  cursor: pointer; user-select: none; line-height: 1;
}
@keyframes starFall { from{top:-30px;opacity:1} to{top:calc(100% + 5px);opacity:.4} }
@keyframes starPop  { 0%{transform:scale(1)} 50%{transform:scale(1.8)} 100%{transform:scale(0);opacity:0} }
